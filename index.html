<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Some F Squares</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    #grid{
        display:inline-block
    }
    #grid-container {
      display: grid;
      grid-template-columns: repeat(19, 36px);
      grid-template-rows: repeat(19, 36px);
      gap: 1px;
      grid-auto-flow: column;
    }

    #group-counts{
      display: flex;
      gap: 1px;
      border: 1px solid #000;
      grid-auto-flow: column;
    }

    .cell {
      width: 36px;
      height: 36px;
      border: 1px solid #000;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      -webkit-user-select: none; /* Safari */
      -ms-user-select: none; /* IE 10 and IE 11 */
      user-select: none; /* Standard syntax */  
    }
    
    .cell span{
      background-color: white;
    }

    .cell:hover {
      filter: saturate(400%) brightness(0.9);
    }

    .target{
        color: rgb(169, 0, 141);
    }

    .label {
      width: 36px;
      height: 36px;
      display: flex;
      border: 1px solid #000;
      justify-content: center;
      align-items: center;
      font-weight: bold;
    }
    
    .nonZero{
      filter: brightness(0.8);
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Some F Squares</h1>
  <p>"Left Click" - Increase by 1</p>
  <p>"Shift" + "Left Click" - Decrease by 1</p>
  <p>Fill Mode: Click on square to toggle between Fill Value and 0</p>
  <div id = "grid">
    <h3>Region Counts</h3>
    <div id="group-counts"></div>
    <h3>Grid</h3>
    <label for="fillMode">Fill Mode </label>
    <input id = "fillMode" type="checkbox">
    <label for="fillNum">Fill Value </label>
    <input id = "fillNum" type="number"><br> 
    <div id="grid-container"></div>
  </div>

  <script>
    let fillVal = 0;
    let fill = false;

    const fillModeCheckbox = document.getElementById('fillMode');
    const fillNumInput = document.getElementById('fillNum');

    const groups=[
      [ 0,  0,  1,  1,  2,  2,  2,  2,  2,  2,  3,  3,  3,  3,  3,  3,  3],
      [ 0,  0,  0,  1,  1,  1,  1,  2,  2,  2,  3,  4,  4,  4,  4,  3,  3],
      [ 0,  5,  5,  5,  1,  1,  1,  2,  6,  2,  3,  4,  3,  3,  4,  7,  3],
      [ 0,  5,  5,  1,  1,  1,  1,  6,  6,  2,  3,  3,  3,  4,  4,  7,  3],
      [ 0,  5,  8,  1,  6,  6,  6,  6,  9, 11, 11,  3,  3,  4,  7,  7,  3],
      [ 0,  5,  8,  8,  6,  8,  9,  9,  9, 10, 11,  3,  3,  4,  4,  7,  7],
      [ 0,  5, 13,  8,  8,  8,  9,  9,  9, 10, 11,  3,  3, 12,  4,  7,  7],
      [ 0,  5, 13, 13,  8,  9,  9, 10, 10, 10, 11,  3, 11, 12,  7,  7,  7],
      [ 0,  5, 13, 13, 13,  9,  9, 10, 11, 11, 11, 11, 11, 12, 12,  7,  7],
      [ 0,  5, 13, 13, 13, 13, 10, 10, 15, 15, 11, 12, 11, 12,  7,  7,  7],
      [ 0,  5, 13, 13, 13, 10, 10, 14, 14, 15, 15, 12, 12, 12, 12, 12,  7],
      [ 0,  5, 13, 13, 10, 10, 14, 14, 14, 17, 15, 15, 16, 16,  7, 12,  7],
      [ 0,  5, 13, 14, 14, 14, 14, 14, 17, 17, 17, 15, 15, 16,  7,  7,  7],
      [ 0,  5, 14, 14, 14, 14, 14, 14, 17, 19, 17, 16, 16, 16, 16,  7,  7],
      [ 0,  5,  5, 14,  0,  0, 18, 17, 17, 19, 16, 16, 19, 19, 16, 16,  7],
      [ 0,  0,  5,  5,  0, 18, 18, 19, 19, 19, 19, 19, 19, 19,  7,  7,  7],
      [ 0,  0,  0,  0,  0,  0, 18, 18, 18, 18, 18, 18, 18, 19,  7,  7,  7],
    ];

    const colors = [
  'repeating-linear-gradient(45deg, #ffe6cc, #ffe6cc 7px, #ffffff 7px, #ffffff 14px)',
  '#ff9999',
  'repeating-linear-gradient(45deg, #ccffcc, #ccffcc 7px, #ffffff 7px, #ffffff 14px)',
  '#99ff99',
  'repeating-linear-gradient(45deg, #ccccff, #ccccff 7px, #ffffff 7px, #ffffff 14px)',
  '#9999ff',
  'repeating-linear-gradient(45deg, #ffcccc, #ffcccc 7px, #ffffff 7px, #ffffff 14px)',
  '#ffd699',
  'repeating-linear-gradient(45deg, #99ffd6, #99ffd6 7px, #ffffff 7px, #ffffff 14px)',
  '#d699ff',
  'repeating-linear-gradient(45deg, #d699ff, #d699ff 7px, #ffffff 7px, #ffffff 14px)',
  '#99ffd6',
  'repeating-linear-gradient(45deg, #ffd699, #ffd699 7px, #ffffff 7px, #ffffff 14px)',
  '#ffcccc',
  'repeating-linear-gradient(45deg, #9999ff, #9999ff 7px, #ffffff 7px, #ffffff 14px)',
  '#ccccff',
  'repeating-linear-gradient(45deg, #99ff99, #99ff99 7px, #ffffff 7px, #ffffff 14px)',
  '#ccffcc',
  'repeating-linear-gradient(45deg, #ff9999, #ff9999 7px, #ffffff 7px, #ffffff 14px)',
  '#ffe6cc',
];
    // Event listener for the Fill Mode checkbox
    fillModeCheckbox.addEventListener('change', function() {
        fill = this.checked;
        console.log('Fill Mode:', fill);
    });

    // Event listener for the Fill Value number input
    fillNumInput.addEventListener('input', function() {
        fillVal = parseInt(this.value) || 0;
        console.log('Fill Value:', fillVal);
    });

    //Create Group Counts
    const groupCounts = document.getElementById('group-counts');
    for(let i = 0; i < 20; i++){
      const groupCount = document.createElement('div');
      groupCount.classList.add('label');
      groupCount.style.background = colors[i];
      groupCount.id = `g${i}`;
      groupCount.innerText = '0';
      groupCounts.appendChild(groupCount);
    }

    const gridSize = 17;
    const gridContainer = document.getElementById('grid-container');
    const rowLabels = [14, 24, 24, 39, 43, '?', 22, 23, 29, 28, 34, 36, 29, 26, 26, 24, 20];
    const colLabels = [13, 20, 22, 28, 30, 36, 35, 39, 49, 39, 39, '?', 23, 32, 23, 17, 13];
    // Create the grid
    for(let i = 0; i<gridSize; i++){
        const rowLabel = document.createElement('div');
        rowLabel.classList.add('label');
        rowLabel.classList.add('target');
        rowLabel.innerText = rowLabels[i];
        rowLabel.id = `tr${i}`;
        gridContainer.appendChild(rowLabel);
    }

    for(let i = 0; i< 2; i++){
      const dummy = document.createElement('div');
      dummy.classList.add('label');
      gridContainer.appendChild(dummy);
    }

    for(let i = 0; i < gridSize; i++){
      const rowSumLabel = document.createElement('div');
      rowSumLabel.classList.add('label');
      rowSumLabel.innerText = '0';
      rowSumLabel.id = `r${i}`;
      gridContainer.appendChild(rowSumLabel);
    }

    for(let i = 0; i< 2; i++){
      const dummy = document.createElement('div');
      dummy.classList.add('label');
      gridContainer.appendChild(dummy);
    }

    for (let j = 0; j < gridSize; j++) {
      for (let i = 0; i < gridSize; i++) {
        const cell = document.createElement('div');
        cell.classList.add('cell');
        cell.dataset.row = i;
        cell.dataset.col = j;
        cell.innerText = '0';
        const colorIndex = groups[i][j];
        cell.style.background = colors[colorIndex];

        cell.addEventListener('click', toggleCellValue);
        gridContainer.appendChild(cell);
      }
      const colSumLabel = document.createElement('div');
      colSumLabel.classList.add('label');
      colSumLabel.innerText = '0';
      colSumLabel.id = `c${j}`;
      gridContainer.appendChild(colSumLabel);
      //actual Values
      const colLabel = document.createElement('div');
      colLabel.classList.add('label');
      colLabel.classList.add('target');
      colLabel.innerText = colLabels[j];
      colLabel.id = `tc${j}`;
      gridContainer.appendChild(colLabel);
    }

    function toggleCellValue(event) {
      event.preventDefault();
      const cell = event.target;
      const currentValue = parseInt(cell.innerText);
      const newValue = fill? (currentValue===fillVal?0:fillVal) :  Math.max(currentValue + (event.shiftKey? -1 : 1),0);
      cell.innerText = newValue;
      if(newValue == 0){
        cell.classList.remove("nonZero");
      }else{
        cell.classList.add("nonZero");
      }
      updateSums(cell.dataset.row, cell.dataset.col, newValue-currentValue);
    }

    function updateSums(row, col, change) {
      // Update row and column sums
      console.log(`cell: (${row}, ${col}), change: ${change}`);
      const rowSum = document.getElementById(`r${row}`);
      const colSum = document.getElementById(`c${col}`);
      const rowTgt = document.getElementById(`tr${row}`);
      const colTgt = document.getElementById(`tc${col}`);
      colSum.innerText = parseInt(colSum.innerText) + change;
      rowSum.innerText = parseInt(rowSum.innerText) + change;
      if(colTgt.innerText !== "?") colTgt.innerText = parseInt(colTgt.innerText) - change;
      if(rowTgt.innerText !== "?") rowTgt.innerText = parseInt(rowTgt.innerText) - change;

      // Update group sums
      const group = groups[row][col];
      const groupSum = document.getElementById(`g${group}`);
      groupSum.innerText = parseInt(groupSum.innerText)+change;
    }
  </script>
</body>
</html>